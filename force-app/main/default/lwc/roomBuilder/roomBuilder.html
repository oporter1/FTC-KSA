<template>
  <div
    class="container"
    style="display: flex; flex-direction: column; gap: 2rem"
  >
    <div style="font-size: 1rem; color: white">
      Drag and drop a student name into a Hotel Room to complete booking.
    </div>
    <div class="columns">
      <!-- Left Column: Members -->
      <div class="column members-column">
        <div class="column-title" style="">
          <h2 style="line-height: 0">Student Name</h2>
          <div>
            <svg
              width="12"
              height="12"
              viewBox="0 0 12 12"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M2.44608 7.38439C2.26146 7.56901 2.26146 7.82285 2.44608 8.00747L5.90762 11.3998C6.09223 11.5844 6.36916 11.5844 6.55377 11.3998L10.0384 8.00747C10.223 7.82285 10.223 7.56901 10.0384 7.38439L9.39223 6.76131C9.20762 6.5767 8.93069 6.5767 8.74608 6.76131L7.66146 7.82285C7.47685 8.00747 7.15377 7.89208 7.15377 7.61516V1.38439C7.15377 1.15362 6.94608 0.922852 6.69223 0.922852H5.76916C5.51531 0.922852 5.30762 1.1767 5.30762 1.38439V7.61516C5.30762 7.89208 4.98454 8.00747 4.79992 7.82285L3.71531 6.76131C3.53069 6.5767 3.25377 6.5767 3.06916 6.76131L2.44608 7.38439Z"
                fill="white"
              />
            </svg>
          </div>
        </div>
        <ul
          class="member-list"
          data-id="membersArea"
          ondragover={handleDragOver}
          ondragleave={handleDragLeave}
          ondrop={handleDrop}
        >
          <template for:each={membersWithRoomInfo} for:item="member">
            <!-- Member component -->
            <li
              key={member.Id}
              class="member-item"
              draggable="true"
              data-id={member.Id}
              ondragstart={handleDragStart}
              ondragend={handleDragEnd}
            >
              <div class="card-title">{member.Name}</div>
              <div>
                Room Requirements: {member.roomPreference} of
                {member.roomPreferenceName}
              </div>
            </li>
          </template>
        </ul>
      </div>

      <!-- Right Column: Rooms -->
      <div class="column rooms-column">
        <div class="column-title">
          <h2 style="line-height: 0">Rooms</h2>
          <div>
            <svg
              width="12"
              height="12"
              viewBox="0 0 12 12"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M2.44608 7.38439C2.26146 7.56901 2.26146 7.82285 2.44608 8.00747L5.90762 11.3998C6.09223 11.5844 6.36916 11.5844 6.55377 11.3998L10.0384 8.00747C10.223 7.82285 10.223 7.56901 10.0384 7.38439L9.39223 6.76131C9.20762 6.5767 8.93069 6.5767 8.74608 6.76131L7.66146 7.82285C7.47685 8.00747 7.15377 7.89208 7.15377 7.61516V1.38439C7.15377 1.15362 6.94608 0.922852 6.69223 0.922852H5.76916C5.51531 0.922852 5.30762 1.1767 5.30762 1.38439V7.61516C5.30762 7.89208 4.98454 8.00747 4.79992 7.82285L3.71531 6.76131C3.53069 6.5767 3.25377 6.5767 3.06916 6.76131L2.44608 7.38439Z"
                fill="white"
              />
            </svg>
          </div>
        </div>
        <ul class="room-list">
          <template for:each={roomsWithMemberNames} for:item="room">
            <li
              key={room.Id}
              class="room-item"
              data-id={room.Id}
              ondragover={handleDragOver}
              ondragleave={handleDragLeave}
              ondrop={handleDrop}
            >
              <div class="room-header">
                <div class="">
                  <div style="font-weight: bold">Room {room.Name}</div>
                  <div>Room Size: {room.capacity}</div>
                </div>
                <div style="display: flex; gap: 0.5rem; align-items: center">
                  <div>{room.spotsLeftText}</div>

                  <div
                    class="ring-container"
                    style="display: flex; align-items: center; justify-content: center; border-radius: 10000px;"
                    data-id={room.Id}
                    data-name={room.Name}
                  >
                    <template if:false={room.isFull}>
                      <svg class="background-ring" viewBox="0 0 100 100">
                        <circle
                          cx="50"
                          cy="50"
                          r="40"
                          fill="none"
                          stroke="#e6e6e6"
                          stroke-width="10"
                        />
                      </svg>
                      <svg class="progress-ring" viewBox="0 0 100 100">
                        <path
                          data-id="progress-arc"
                          fill="none"
                          stroke="#4a90e2"
                          stroke-width="10"
                          stroke-linecap="round"
                        />
                      </svg>
                    </template>

                    <template if:true={room.isFull}>
                      <svg
                        width="13"
                        height="13"
                        viewBox="0 0 13 13"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          fill-rule="evenodd"
                          clip-rule="evenodd"
                          d="M4.73088 10.3048L0.741611 6.39181C0.596546 6.25037 0.596546 6.01465 0.741611 5.87322L1.27351 5.35464C1.41858 5.21321 1.66035 5.21321 1.80542 5.35464L4.80341 8.30114C4.90012 8.39543 5.06937 8.39543 5.16608 8.30114L11.0412 2.526C11.1862 2.38456 11.428 2.38456 11.5731 2.526L12.105 3.04458C12.2501 3.18601 12.2501 3.42173 12.105 3.56316L5.26278 10.3048C5.11772 10.4698 4.87595 10.4698 4.73088 10.3048V10.3048Z"
                          fill="white"
                        />
                      </svg>
                    </template>
                  </div>
                </div>
              </div>
              <div class="">
                <ul
                  class="member-list"
                  style="
                    padding: 0;
                    display: flex;
                    flex-direction: column;
                    gap: 0.5rem;
                    background-color: transparent;
                  "
                >
                  <template for:each={room.assignedMembers} for:item="member">
                    <!-- Member component -->
                    <li
                      key={member.Id}
                      class="member-item"
                      style="margin: 0"
                      draggable="true"
                      data-id={member.Id}
                      ondragstart={handleDragStart}
                      ondragend={handleDragEnd}
                    >
                      <div style="font-weight: bold">{member.Name}</div>
                      <div>
                        Room Requirements: {member.roomPreference} of
                        {member.roomPreferenceName}
                      </div>
                    </li>
                  </template>
                </ul>
              </div>
            </li>
          </template>
        </ul>
      </div>
    </div>
  </div>
</template>
